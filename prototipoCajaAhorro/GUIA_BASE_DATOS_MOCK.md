# üìö Gu√≠a de Uso: Base de Datos Mock

## üéØ Descripci√≥n

He creado una **base de datos mock profesional y centralizada** para el prototipo. Esta base de datos simula de forma realista el funcionamiento de un sistema bancario completo con datos coherentes y relacionados.

---

## ‚úÖ ¬øPor Qu√© Es Importante?

### ‚ùå Antes (Datos Dispersos):
```typescript
// En cada componente, datos diferentes y desconectados
const ClienteSearch.tsx:
  const clientes = [
    { id: '1', cedula: '1234567890', ... },
    { id: '2', cedula: '0987654321', ... },
  ];

const DepositosScreen.tsx:
  const clientes = [
    { id: '1', cedula: '9999999999', ... }, // ¬°Diferentes!
  ];
```

### ‚úÖ Ahora (Datos Centralizados):
```typescript
// Un solo lugar, datos consistentes en toda la app
import { mockDB } from '@/infrastructure/persistence/MockDatabase';

const clientes = mockDB.getClientes(); // Mismo en toda la app
```

---

## üìä Datos Incluidos

La base de datos mock contiene:

### üë• **6 Clientes** (con datos realistas de Ecuador)
- Juan Carlos P√©rez Gonz√°lez (C√©dula: 1714567890)
- Mar√≠a Elena G√≥mez Rodr√≠guez (C√©dula: 1705432198)
- Roberto Mart√≠nez Silva (C√©dula: 1723456789)
- Ana Patricia L√≥pez Vargas (C√©dula: 1708765432)
- Luis Fernando Castro Morales (C√©dula: 1719876543)
- Carmen Rosa Jim√©nez P√°ez (C√©dula: 1704321987)

### üí≥ **7 Cuentas** (B√°sicas, Infantiles, Ahorro Futuro)
- 5 Cuentas B√°sicas
- 1 Cuenta Infantil
- 1 Cuenta Ahorro Futuro

### üí∞ **8 Transacciones** (Aperturas, Dep√≥sitos, Cobros)
- Historial completo de movimientos
- Saldos actualizados

### üìã **2 Pr√©stamos** (Activos con cuotas)
- Pr√©stamo Personal $5,000
- Pr√©stamo Personal $8,000

### üßæ **3 Cobranzas** (Cuotas pendientes)
- 1 cuota vencida (con mora)
- 2 cuotas al d√≠a

### üìÑ **7 Recibos** (Impresos y enviados)

### üë®‚Äçüíº **2 Agentes** (Usuarios del sistema)
- Carlos Mendoza (usuario: cmendoza, password: 123456)
- Mar√≠a Rodr√≠guez (usuario: mrodriguez, password: 123456)

### üìû **4 Referencias Personales**

---

## üöÄ C√≥mo Usar

### 1. **Importar la Base de Datos**

```typescript
import { mockDB } from '@/infrastructure/persistence/MockDatabase';
```

### 2. **Consultar Datos**

#### Obtener Todos los Clientes:
```typescript
const clientes = mockDB.getClientes();
console.log(clientes); // Array de 6 clientes
```

#### Buscar Cliente por C√©dula:
```typescript
const cliente = mockDB.getClienteByCedula('1714567890');
console.log(cliente?.nombre); // "Juan Carlos"
```

#### Buscar Clientes (por cualquier campo):
```typescript
const resultados = mockDB.buscarClientes('Mar√≠a');
// Retorna todos los clientes que contengan "Mar√≠a"
```

#### Obtener Cuentas de un Cliente:
```typescript
const cuentas = mockDB.getCuentasByCliente('CLI001');
console.log(cuentas); // Array de cuentas de Juan Carlos
```

#### Obtener Transacciones de una Cuenta:
```typescript
const transacciones = mockDB.getTransaccionesByCuenta('CTA001');
console.log(transacciones); // Historial completo
```

#### Obtener Cobranzas Pendientes de un Cliente:
```typescript
const cobranzas = mockDB.getCobranzasByCliente('CLI001');
const pendientes = cobranzas.filter(c => !c.pagado);
console.log(pendientes); // Cuotas por pagar
```

#### Dashboard del D√≠a:
```typescript
const dashboard = mockDB.getDashboardData('2024-01-15', 'AG001');
console.log(dashboard);
// {
//   fecha: '2024-01-15',
//   cuentasAperturadas: 2,
//   totalDepositos: { cantidad: 3, monto: 1250 },
//   totalCobros: { cantidad: 2, monto: 900 },
//   montoTotalRecaudado: 2150,
//   transacciones: [...]
// }
```

---

## üíª Ejemplos Pr√°cticos

### Ejemplo 1: Actualizar ClienteSearch.tsx

**Antes:**
```typescript
const ClienteSearch.tsx:
  const clientesEjemplo: Cliente[] = [
    { id: '1', cedula: '1234567890', ... },
    // Datos hardcodeados
  ];
```

**Despu√©s:**
```typescript
import { mockDB } from '@/infrastructure/persistence/MockDatabase';

const ClienteSearch: React.FC<Props> = ({ onClienteSelect }) => {
  const [resultados, setResultados] = useState<Cliente[]>([]);

  const buscarClientes = (termino: string) => {
    if (termino.length >= 3) {
      const results = mockDB.buscarClientes(termino);
      setResultados(results);
    }
  };

  // ... resto del c√≥digo
};
```

### Ejemplo 2: Actualizar DepositosScreen.tsx

**Despu√©s:**
```typescript
import { mockDB } from '@/infrastructure/persistence/MockDatabase';

const DepositosScreen: React.FC<Props> = ({ navigation }) => {
  const [cuenta, setCuenta] = useState<Cuenta | null>(null);

  const handleClienteSelect = (cliente: Cliente) => {
    // Obtener cuentas del cliente
    const cuentasCliente = mockDB.getCuentasByCliente(cliente.id);
    
    // Seleccionar la primera cuenta b√°sica
    const cuentaBasica = cuentasCliente.find(c => c.tipo === 'BASICA');
    setCuenta(cuentaBasica || null);
  };

  const realizarDeposito = async (monto: number) => {
    if (!cuenta) return;

    // Crear nueva transacci√≥n
    const nuevaTransaccion: Transaccion = {
      id: `TRX${mockDB.getTransacciones().length + 1}`,
      numero: mockDB.generarNumeroTransaccion(),
      cuentaId: cuenta.id,
      clienteId: cuenta.clienteId,
      tipo: 'DEPOSITO',
      monto: monto,
      saldoAnterior: cuenta.saldo,
      saldoNuevo: cuenta.saldo + monto,
      estado: 'COMPLETADA',
      fecha: new Date().toISOString().split('T')[0],
      hora: new Date().toLocaleTimeString(),
      concepto: 'Dep√≥sito en efectivo',
      agenteId: 'AG001',
    };

    // Agregar a la base de datos
    mockDB.agregarTransaccion(nuevaTransaccion);

    Alert.alert('√âxito', 'Dep√≥sito realizado correctamente');
  };
};
```

### Ejemplo 3: Actualizar CobrosScreen.tsx

**Despu√©s:**
```typescript
import { mockDB } from '@/infrastructure/persistence/MockDatabase';

const CobrosScreen: React.FC<Props> = () => {
  const [cobranzas, setCobranzas] = useState<Cobranza[]>([]);

  const handleClienteSelect = (cliente: Cliente) => {
    // Obtener cobranzas pendientes del cliente
    const cobranzasCliente = mockDB.getCobranzasByCliente(cliente.id);
    const pendientes = cobranzasCliente.filter(c => !c.pagado);
    setCobranzas(pendientes);
  };

  // Calcular total con mora
  const calcularTotal = (cobranza: Cobranza) => {
    return cobranza.montoCuota + cobranza.montoMora;
  };
};
```

### Ejemplo 4: Actualizar ActividadScreen.tsx (Dashboard)

**Despu√©s:**
```typescript
import { mockDB } from '@/infrastructure/persistence/MockDatabase';

const ActividadScreen: React.FC = () => {
  const [dashboardData, setDashboardData] = useState(null);

  useEffect(() => {
    const hoy = new Date().toISOString().split('T')[0];
    const data = mockDB.getDashboardData(hoy, 'AG001');
    setDashboardData(data);
  }, []);

  // Mostrar estad√≠sticas reales
  return (
    <View>
      <Text>Cuentas Aperturadas: {dashboardData?.cuentasAperturadas}</Text>
      <Text>Total Recaudado: ${dashboardData?.montoTotalRecaudado.toFixed(2)}</Text>
    </View>
  );
};
```

### Ejemplo 5: Login de Agente

```typescript
import { mockDB } from '@/infrastructure/persistence/MockDatabase';

const LoginScreen: React.FC = ({ navigation }) => {
  const [usuario, setUsuario] = useState('');
  const [password, setPassword] = useState('');

  const handleLogin = () => {
    const agente = mockDB.autenticarAgente(usuario, password);
    
    if (agente) {
      // Guardar sesi√≥n
      Alert.alert('√âxito', `Bienvenido ${agente.nombre}`);
      navigation.navigate('Home');
    } else {
      Alert.alert('Error', 'Usuario o contrase√±a incorrectos');
    }
  };

  // Usuario de prueba: cmendoza / 123456
};
```

---

## üîß M√©todos Disponibles

### Clientes
```typescript
mockDB.getClientes()                    // Todos los clientes
mockDB.getClienteById(id)               // Por ID
mockDB.getClienteByCedula(cedula)       // Por c√©dula
mockDB.buscarClientes(termino)          // B√∫squeda general
mockDB.agregarCliente(cliente)          // Agregar nuevo
```

### Cuentas
```typescript
mockDB.getCuentas()                     // Todas las cuentas
mockDB.getCuentaById(id)                // Por ID
mockDB.getCuentaByNumero(numero)        // Por n√∫mero de cuenta
mockDB.getCuentasByCliente(clienteId)   // De un cliente
mockDB.getCuentasBasicas()              // Solo b√°sicas
```

### Transacciones
```typescript
mockDB.getTransacciones()                      // Todas
mockDB.getTransaccionesByCuenta(cuentaId)      // De una cuenta
mockDB.getTransaccionesByCliente(clienteId)    // De un cliente
mockDB.getTransaccionesByFecha(fecha)          // Por fecha
mockDB.getTransaccionesByAgente(agenteId)      // Por agente
mockDB.agregarTransaccion(transaccion)         // Agregar nueva
```

### Pr√©stamos y Cobranzas
```typescript
mockDB.getPrestamos()                   // Todos los pr√©stamos
mockDB.getPrestamosByCliente(id)        // De un cliente
mockDB.getPrestamosActivos()            // Solo activos
mockDB.getCobranzas()                   // Todas las cobranzas
mockDB.getCobranzasByCliente(id)        // De un cliente
mockDB.getCobranzasPendientes()         // No pagadas
mockDB.getCobranzasConMora()            // Con mora
```

### Recibos
```typescript
mockDB.getRecibos()                     // Todos
mockDB.getRecibosByCliente(id)          // De un cliente
mockDB.agregarRecibo(recibo)            // Agregar nuevo
```

### Agentes
```typescript
mockDB.getAgentes()                     // Todos
mockDB.getAgenteById(id)                // Por ID
mockDB.autenticarAgente(user, pass)     // Login
```

### Dashboard
```typescript
mockDB.getDashboardData(fecha, agenteId?)  // Estad√≠sticas del d√≠a
```

### Utilidades
```typescript
mockDB.generarNumeroCuenta(tipo)        // Genera n√∫mero de cuenta
mockDB.generarNumeroTransaccion()       // Genera n√∫mero de recibo
```

---

## üé® Tipos y Enums Disponibles

```typescript
import { 
  TipoCuenta,           // BASICA, INFANTIL, AHORRO_FUTURO
  EstadoCuenta,         // ACTIVA, INACTIVA, BLOQUEADA
  TipoTransaccion,      // DEPOSITO, RETIRO, COBRO, APERTURA
  EstadoTransaccion,    // COMPLETADA, PENDIENTE, CANCELADA
  EstadoPrestamo,       // ACTIVO, PAGADO, VENCIDO
  Cliente,
  Cuenta,
  Transaccion,
  Prestamo,
  Cobranza,
  Agente,
  Recibo,
} from '@/infrastructure/persistence/MockDatabase';
```

---

## üìã Relaciones Entre Datos

```
Cliente (CLI001)
  ‚îú‚îÄ‚îÄ Cuenta B√°sica (CTA001)
  ‚îÇ   ‚îú‚îÄ‚îÄ Transacci√≥n: Apertura (TRX001)
  ‚îÇ   ‚îú‚îÄ‚îÄ Transacci√≥n: Dep√≥sito (TRX003)
  ‚îÇ   ‚îú‚îÄ‚îÄ Transacci√≥n: Dep√≥sito (TRX004)
  ‚îÇ   ‚îú‚îÄ‚îÄ Transacci√≥n: Cobro (TRX006)
  ‚îÇ   ‚îî‚îÄ‚îÄ Transacci√≥n: Cobro (TRX007)
  ‚îÇ
  ‚îú‚îÄ‚îÄ Cuenta Ahorro Futuro (CTA005)
  ‚îÇ   ‚îî‚îÄ‚îÄ Vinculada a CTA001
  ‚îÇ
  ‚îú‚îÄ‚îÄ Pr√©stamo (PRE001)
  ‚îÇ   ‚îú‚îÄ‚îÄ Cobranza Cuota 4 (COB001) - VENCIDA + MORA
  ‚îÇ   ‚îî‚îÄ‚îÄ Cobranza Cuota 5 (COB002) - PENDIENTE
  ‚îÇ
  ‚îî‚îÄ‚îÄ Referencias Personales
      ‚îú‚îÄ‚îÄ Pedro P√©rez (Hermano)
      ‚îî‚îÄ‚îÄ Rosa Gonz√°lez (Madre)
```

---

## üéØ Usuarios de Prueba

### Agente 1:
- **Usuario:** `cmendoza`
- **Password:** `123456`
- **Nombre:** Carlos Mendoza L√≥pez
- **Zona:** Norte de Quito

### Agente 2:
- **Usuario:** `mrodriguez`
- **Password:** `123456`
- **Nombre:** Mar√≠a Rodr√≠guez Castro
- **Zona:** Sur de Quito

### Clientes de Prueba:
```typescript
// Cliente con pr√©stamo y mora
C√©dula: 1714567890 (Juan Carlos P√©rez)
Cuenta: AH-001-2024
Saldo: $1,850.50
Pr√©stamo: $5,000 (cuota vencida con mora)

// Cliente con cuenta infantil
C√©dula: 1708765432 (Ana Patricia L√≥pez)
Cuenta: AI-001-2024 (Infantil de Sebasti√°n L√≥pez)
Saldo: $589.25

// Cliente con ahorro futuro
C√©dula: 1714567890 (Juan Carlos P√©rez)
Cuenta: AF-001-2024 (90 d√≠as, vence 2024-04-10)
Saldo: $1,000.00 (bloqueado)
```

---

## üî• Ventajas de Esta Base de Datos Mock

### 1. **Datos Realistas** ‚úÖ
- C√©dulas ecuatorianas v√°lidas
- Direcciones reales de Quito
- Coordenadas GPS correctas
- Relaciones coherentes entre entidades

### 2. **Totalmente Funcional** ‚úÖ
- M√©todos CRUD completos
- B√∫squedas optimizadas
- Generaci√≥n autom√°tica de n√∫meros
- Actualizaci√≥n autom√°tica de saldos

### 3. **F√°cil de Usar** ‚úÖ
- Una sola importaci√≥n
- API intuitiva
- TypeScript con tipos
- Documentaci√≥n completa

### 4. **Preparada para Producci√≥n** ‚úÖ
- Estructura compatible con SQLite
- F√°cil migraci√≥n a backend real
- Misma interfaz que repositorios reales

### 5. **Ideal para Demos** ‚úÖ
- Datos variados para mostrar
- Casos de uso completos
- Flujos realistas
- Sin necesidad de internet

---

## üöÄ Plan de Migraci√≥n

### Paso 1: Usar Mock (ACTUAL)
```typescript
import { mockDB } from '@/infrastructure/persistence/MockDatabase';
const clientes = mockDB.getClientes();
```

### Paso 2: Crear Repositorio Real
```typescript
class ClienteRepositoryImpl implements IClienteRepository {
  async getClientes(): Promise<Cliente[]> {
    // En desarrollo: usar mock
    return mockDB.getClientes();
    
    // En producci√≥n: usar SQLite o API
    // return await db.query('SELECT * FROM clientes');
  }
}
```

### Paso 3: Inyectar Dependencia
```typescript
// El c√≥digo de UI no cambia, solo cambias el repositorio
const repository = new ClienteRepositoryImpl();
const clientes = await repository.getClientes();
```

---

## üìä Estad√≠sticas de la Base de Datos

```
Total de Registros: 41
‚îú‚îÄ‚îÄ Agentes: 2
‚îú‚îÄ‚îÄ Clientes: 6
‚îú‚îÄ‚îÄ Referencias: 4
‚îú‚îÄ‚îÄ Cuentas: 7
‚îú‚îÄ‚îÄ Transacciones: 8
‚îú‚îÄ‚îÄ Pr√©stamos: 2
‚îú‚îÄ‚îÄ Cobranzas: 3
‚îî‚îÄ‚îÄ Recibos: 7

Relaciones:
‚îú‚îÄ‚îÄ Cliente ‚Üí Cuentas: 1 a N
‚îú‚îÄ‚îÄ Cliente ‚Üí Pr√©stamos: 1 a N
‚îú‚îÄ‚îÄ Cuenta ‚Üí Transacciones: 1 a N
‚îú‚îÄ‚îÄ Pr√©stamo ‚Üí Cobranzas: 1 a N
‚îî‚îÄ‚îÄ Transacci√≥n ‚Üí Recibo: 1 a 1
```

---

## üéì Ejemplos Avanzados

### Ejemplo: Crear Nueva Transacci√≥n y Recibo

```typescript
const realizarDepositoCompleto = (cuenta: Cuenta, monto: number, agenteId: string) => {
  // 1. Crear transacci√≥n
  const transaccion: Transaccion = {
    id: `TRX${Date.now()}`,
    numero: mockDB.generarNumeroTransaccion(),
    cuentaId: cuenta.id,
    clienteId: cuenta.clienteId,
    tipo: TipoTransaccion.DEPOSITO,
    monto: monto,
    saldoAnterior: cuenta.saldo,
    saldoNuevo: cuenta.saldo + monto,
    estado: EstadoTransaccion.COMPLETADA,
    fecha: new Date().toISOString().split('T')[0],
    hora: new Date().toLocaleTimeString('es-EC'),
    concepto: 'Dep√≥sito en efectivo',
    agenteId: agenteId,
  };

  // 2. Agregar transacci√≥n (actualiza saldo autom√°ticamente)
  mockDB.agregarTransaccion(transaccion);

  // 3. Crear recibo
  const recibo: Recibo = {
    id: `REC${Date.now()}`,
    numero: transaccion.numero,
    transaccionId: transaccion.id,
    clienteId: cuenta.clienteId,
    tipo: 'Dep√≥sito',
    monto: monto,
    fecha: transaccion.fecha,
    hora: transaccion.hora,
    estado: 'IMPRESO',
    agenteId: agenteId,
  };

  // 4. Agregar recibo
  mockDB.agregarRecibo(recibo);

  return { transaccion, recibo };
};
```

### Ejemplo: Validar Cuota con Mora

```typescript
const validarCuotaConMora = (cobranza: Cobranza) => {
  const hoy = new Date();
  const fechaVencimiento = new Date(cobranza.fechaVencimiento);
  
  if (hoy > fechaVencimiento && !cobranza.pagado) {
    const diasMora = Math.floor((hoy.getTime() - fechaVencimiento.getTime()) / (1000 * 60 * 60 * 24));
    const porcentajeMora = 0.05; // 5% por d√≠a
    const montoMora = cobranza.montoCuota * porcentajeMora * diasMora;
    
    return {
      ...cobranza,
      diasMora,
      montoMora,
      totalAPagar: cobranza.montoCuota + montoMora,
    };
  }
  
  return cobranza;
};
```

---

## ‚úÖ Checklist de Integraci√≥n

- [ ] Importar mockDB en componentes
- [ ] Reemplazar datos hardcodeados
- [ ] Usar m√©todos de b√∫squeda
- [ ] Probar flujos completos
- [ ] Verificar relaciones entre datos
- [ ] Actualizar tipos TypeScript
- [ ] Documentar cambios

---

## üéâ Conclusi√≥n

Esta base de datos mock profesional transforma tu prototipo en una aplicaci√≥n completamente funcional y demostrable. Los datos son coherentes, las relaciones est√°n bien definidas, y la API es f√°cil de usar.

**Beneficios:**
- ‚ö° Prototipo 100% funcional
- üéØ Demos profesionales
- üîÑ F√°cil migraci√≥n a producci√≥n
- üìä Datos realistas y consistentes
- üöÄ Base s√≥lida para el futuro

---

**Creado por:** Asistente de Desarrollo  
**Fecha:** Octubre 2024  
**Versi√≥n:** 1.0

